# Zomboid 备份管理器

一个用于备份和恢复 Project Zomboid 存档的图形化应用程序。

## 功能特点

- 🔄 **自动备份**: 一键备份 Zomboid 存档到指定目录
- 📋 **备份列表**: 查看所有历史备份及其详细信息
- 🔙 **快速恢复**: 双击或右键菜单恢复任何备份
- 🗑️ **自动清理**: 自动删除旧备份，保留指定数量的最新备份
- ⚙️ **配置管理**: 可自定义源目录、备份目录和保留数量
- 📊 **大小统计**: 显示每个备份的文件大小
- 🖱️ **右键菜单**: 恢复、删除、打开备份文件夹等操作

## 安装和运行

### 方法1: 直接运行
```bash
python zomboid_backup_manager.py
```

### 方法2: 使用批处理文件
双击 `run_backup_manager.bat` 文件

## 使用说明

### 首次使用
1. 启动程序后，检查配置设置：
   - **存档目录**: Zomboid 存档的位置（默认: `C:\Users\Administrator\Zomboid\Saves\Sandbox`）
   - **备份目录**: 备份文件的存储位置（默认: `D:\backup`）
   - **保留备份数**: 最多保留多少个备份（默认: 10个）

2. 如需修改配置，点击对应的"浏览"按钮选择目录，或直接编辑文本框

3. 点击"保存配置"按钮保存设置

### 备份操作
1. 确认配置正确后，点击"立即备份"按钮
2. 程序会自动：
   - 检查源目录是否存在
   - 创建带时间戳的备份文件夹
   - 复制所有存档文件
   - 显示备份完成信息和文件大小
   - 自动清理超出数量限制的旧备份

### 恢复操作
1. 在备份列表中找到要恢复的备份
2. 双击备份项目，或右键选择"恢复此备份"
3. 确认恢复操作（会覆盖当前存档）
4. 程序会自动备份当前存档（防止恢复失败）并执行恢复

### 其他操作
- **刷新列表**: 手动刷新备份列表
- **删除备份**: 右键选择"删除此备份"永久删除选中的备份
- **打开文件夹**: 右键选择"打开备份文件夹"在资源管理器中查看

## 配置文件

程序会在运行目录创建 `config.json` 文件保存配置：

```json
{
  "source_path": "C:\\Users\\Administrator\\Zomboid\\Saves\\Sandbox",
  "backup_root": "D:\\backup", 
  "max_backups": 10
}
```

## 备份文件格式

备份文件夹命名格式: `Zomboid_Backup_YYYY-MM-DD_HH-MM-SS`

例如: `Zomboid_Backup_2025-01-15_14-30-25`

## 注意事项

1. **备份前确保游戏已关闭**: 避免文件被占用导致备份失败
2. **恢复会覆盖当前存档**: 恢复操作会完全替换当前存档
3. **磁盘空间**: 确保备份目录有足够的磁盘空间
4. **权限**: 确保程序对源目录和备份目录有读写权限

## 系统要求

- Python 3.6+
- Windows 操作系统
- tkinter (通常随 Python 一起安装)

## 故障排除

### 常见问题

**Q: 提示"源目录不存在"**
A: 检查 Zomboid 存档路径是否正确，默认路径可能因用户不同而变化

**Q: 备份失败，提示权限错误**
A: 确保程序有足够权限访问源目录和备份目录，尝试以管理员身份运行

**Q: 恢复后游戏存档异常**
A: 检查恢复的备份是否完整，程序会在恢复前自动备份当前存档以防意外

**Q: 程序界面显示异常**
A: 检查 Python 环境是否正确安装 tkinter 模块

### 技术支持

如遇到问题，请检查：
1. Python 版本是否兼容
2. 文件路径是否正确
3. 是否有足够的磁盘空间
4. 防病毒软件是否阻止了文件操作

pyinstaller --onefile --windowed --name="Zomboid备份管理器" zomboid_backup_manager.py
